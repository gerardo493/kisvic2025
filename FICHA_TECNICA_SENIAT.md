# FICHA T√âCNICA PARA HOMOLOGACI√ìN SENIAT
## Sistema Fiscal Cumplimiento Providencia 00102

---

### üìã INFORMACI√ìN GENERAL DEL SISTEMA

**Nombre del Sistema:** Sistema Fiscal Web Homologado SENIAT  
**Versi√≥n:** 1.0.0  
**Desarrollador:** [Nombre de la Empresa]  
**Fecha de Desarrollo:** 2024  
**Prop√≥sito:** Sistema de facturaci√≥n electr√≥nica con cumplimiento total de requisitos SENIAT seg√∫n Providencia 00102  

---

### üèóÔ∏è ARQUITECTURA T√âCNICA

#### **Lenguajes de Programaci√≥n:**
- **Backend:** Python 3.8+
- **Framework Web:** Flask 2.0+
- **Frontend:** HTML5, CSS3, JavaScript ES6+
- **Templates:** Jinja2

#### **Base de Datos:**
- **Tipo:** H√≠brida
- **Documentos Fiscales:** JSON con validaci√≥n de integridad
- **Metadatos:** SQLite para datos auxiliares
- **Logs de Auditor√≠a:** Archivos de texto con hash inmutable

#### **Estructura de Directorios:**
```
mi_app_web/
‚îú‚îÄ‚îÄ app.py                          # Aplicaci√≥n principal Flask
‚îú‚îÄ‚îÄ seguridad_fiscal.py             # M√≥dulo de seguridad SENIAT
‚îú‚îÄ‚îÄ numeracion_fiscal.py            # Control de numeraci√≥n consecutiva
‚îú‚îÄ‚îÄ comunicacion_seniat.py          # APIs para comunicaci√≥n SENIAT
‚îú‚îÄ‚îÄ exportacion_seniat.py           # Exportaci√≥n de datos fiscales
‚îú‚îÄ‚îÄ auth.py                         # Sistema de autenticaci√≥n
‚îú‚îÄ‚îÄ requirements.txt                # Dependencias del sistema
‚îú‚îÄ‚îÄ facturas_json/                  # Documentos fiscales inmutables
‚îú‚îÄ‚îÄ logs/                           # Logs de auditor√≠a fiscal
‚îú‚îÄ‚îÄ exportaciones_seniat/           # Exportaciones para auditor√≠a
‚îú‚îÄ‚îÄ documentos_fiscales/            # Respaldos de seguridad
‚îú‚îÄ‚îÄ backups_seguridad/              # Copias de seguridad cifradas
‚îî‚îÄ‚îÄ templates/                      # Plantillas HTML
```

---

### üîê SEGURIDAD Y CUMPLIMIENTO SENIAT

#### **1. Inviolabilidad y Protecci√≥n de Datos**

##### **Inmutabilidad de Documentos:**
- ‚úÖ **Hash SHA-256:** Cada documento fiscal genera un hash √∫nico e inmutable
- ‚úÖ **Firma Digital HMAC:** Validaci√≥n de integridad con clave secreta
- ‚úÖ **Metadatos de Seguridad:** Informaci√≥n de creaci√≥n y validaci√≥n
- ‚úÖ **Prevenci√≥n de Modificaciones:** Documentos marcados como inmutables

```python
# Ejemplo de estructura de seguridad
{
    "_metadatos_seguridad": {
        "tipo_documento": "FACTURA",
        "fecha_creacion": "2024-01-15T10:30:45.123",
        "mac_address": "00:1B:44:11:3A:B7",
        "hostname": "fiscal-server",
        "version_sistema": "1.0.0",
        "inmutable": true,
        "id_documento": "uuid-unico",
        "hash_inmutable": "sha256-hash",
        "firma_digital": "hmac-signature"
    }
}
```

##### **Cifrado de Datos:**
- ‚úÖ **Algoritmo:** AES-256 con PBKDF2
- ‚úÖ **Datos en Reposo:** Documentos sensibles cifrados
- ‚úÖ **Datos en Tr√°nsito:** HTTPS/TLS 1.3
- ‚úÖ **Gesti√≥n de Claves:** Derivaci√≥n segura de claves

#### **2. Trazabilidad Completa (Logs de Auditor√≠a)**

##### **Registro Autom√°tico:**
- ‚úÖ **Formato Est√°ndar:** Logs estructurados con hash de integridad
- ‚úÖ **Informaci√≥n Completa:** Usuario, IP, MAC, timestamp preciso
- ‚úÖ **Inmutabilidad:** Logs con hash SHA-256 para prevenir alteraciones

##### **Detalle de Logs:**
```
[2024-01-15 10:30:45.123] USUARIO:admin | ACCION:NUEVA_FACTURA_FISCAL | 
DOC_TIPO:FACTURA | DOC_NUM:FAC-00000001 | IP_EXT:190.202.123.123 | 
IP_LOC:192.168.1.100 | MAC:00:1B:44:11:3A:B7 | HOST:fiscal-server | 
DETALLES:Total: $150.00, Cliente: EMPRESA ABC | HASH:sha256-hash-inmutable
```

#### **3. Control de Documentos Fiscales**

##### **Numeraci√≥n √önica y Consecutiva:**
- ‚úÖ **Series Fiscales:** FAC-, NC-, ND- con numeraci√≥n autom√°tica
- ‚úÖ **Validaci√≥n:** Prevenci√≥n de duplicados y saltos
- ‚úÖ **Atomicidad:** Control thread-safe de numeraci√≥n
- ‚úÖ **Auditor√≠a:** Registro de cada asignaci√≥n de n√∫mero

```json
{
    "series": {
        "FACTURA": {
            "prefijo": "FAC-",
            "siguiente_numero": 1,
            "formato": "FAC-{numero:08d}",
            "activa": true,
            "longitud_numero": 8
        }
    }
}
```

##### **Timestamps Precisos:**
- ‚úÖ **Formato:** HH:MM:SS (segundos incluidos)
- ‚úÖ **Hora de Emisi√≥n:** Autom√°tica al crear documento
- ‚úÖ **Zona Horaria:** Venezuela (VET)

##### **Sistema de Correcciones:**
- ‚úÖ **Facturas Inmutables:** No se pueden modificar una vez creadas
- ‚úÖ **Notas de Cr√©dito/D√©bito:** √önica forma de correcci√≥n permitida
- ‚úÖ **Referencia Obligatoria:** Link a factura original

#### **4. Validaci√≥n de Campos Obligatorios (Providencia 00102)**

‚úÖ **Campos Validados Autom√°ticamente:**
- N√∫mero de factura √∫nico
- Fecha y hora de emisi√≥n (HH:MM:SS)
- Datos completos del cliente (RIF, nombre, direcci√≥n)
- Items con descripciones y precios
- Totales en USD y VES
- Tasa de cambio BCV
- Condiciones de pago
- IVA calculado correctamente

---

### üåê COMUNICACI√ìN DIRECTA CON SENIAT

#### **APIs Implementadas:**

##### **Env√≠o de Documentos:**
- ‚úÖ **Endpoint:** `/seniat/envio/facturas`
- ‚úÖ **M√©todo:** POST con JSON estructurado
- ‚úÖ **Autenticaci√≥n:** Bearer Token + RIF empresa
- ‚úÖ **Reintentos:** Sistema autom√°tico con backoff
- ‚úÖ **Manejo de Errores:** Procesamiento de respuestas SENIAT

##### **Consulta de Estados:**
- ‚úÖ **Endpoint:** `/seniat/consulta/documento`
- ‚úÖ **Verificaci√≥n:** Estado de documentos enviados
- ‚úÖ **Logs:** Registro de todas las consultas

```python
# Ejemplo de payload para SENIAT
{
    "empresa": {
        "rif": "J-123456789",
        "codigo_contribuyente": "ABC123"
    },
    "documento": {
        "tipo": "FACTURA",
        "numero": "FAC-00000001",
        "fecha": "2024-01-15",
        "hora": "10:30:45"
    },
    "cliente": { /* datos del cliente */ },
    "items": [ /* productos facturados */ ],
    "totales": { /* c√°lculos fiscales */ },
    "metadatos_seguridad": { /* hash e integridad */ }
}
```

---

### üîç ACCESO Y AUDITOR√çA PARA EL SENIAT

#### **Interfaz de Consulta Segura:**

##### **Endpoints Disponibles para SENIAT:**
```
GET /seniat/consulta                    # Informaci√≥n del sistema
GET /seniat/facturas/consultar          # Consulta de facturas
GET /seniat/exportar/facturas           # Exportaci√≥n de facturas
GET /seniat/exportar/logs               # Exportaci√≥n de logs
GET /seniat/auditoria/integridad        # Verificaci√≥n de integridad
GET /seniat/sistema/estado              # Estado del sistema
GET /seniat/reporte/consolidado         # Reporte completo
```

##### **Autenticaci√≥n SENIAT:**
- ‚úÖ **Headers Requeridos:** `Authorization`, `X-SENIAT-Token`
- ‚úÖ **Validaci√≥n:** Verificaci√≥n de credenciales oficiales
- ‚úÖ **Logs:** Registro de todos los accesos SENIAT

#### **Exportaci√≥n de Datos:**

##### **Formatos Soportados:**
- ‚úÖ **CSV:** Para an√°lisis en hojas de c√°lculo
- ‚úÖ **XML:** Formato estructurado est√°ndar
- ‚úÖ **JSON:** Datos completos con metadatos

##### **Filtros Disponibles:**
- Rango de fechas (desde/hasta)
- Tipo de documento (facturas, notas)
- RIF de cliente espec√≠fico
- N√∫mero de documento

##### **Reporte Consolidado:**
- ‚úÖ **Contenido:** Todos los formatos en ZIP comprimido
- ‚úÖ **Metadatos:** Informaci√≥n de la exportaci√≥n
- ‚úÖ **Integridad:** Verificaci√≥n de datos incluida

---

### üìä VALIDACI√ìN DE INTEGRIDAD

#### **Verificaciones Autom√°ticas:**
- ‚úÖ **Hash de Documentos:** Validaci√≥n SHA-256
- ‚úÖ **Firmas Digitales:** Verificaci√≥n HMAC
- ‚úÖ **Secuencias Num√©ricas:** Control de consecutivos
- ‚úÖ **Timestamps:** Validaci√≥n de fechas/horas

#### **Endpoint de Integridad:**
```json
GET /seniat/auditoria/integridad
{
    "total_documentos": 1500,
    "documentos_validos": 1500,
    "documentos_invalidos": 0,
    "porcentaje_integridad": 100.0,
    "documentos_con_problemas": [],
    "timestamp_verificacion": "2024-01-15T15:30:00.000Z"
}
```

---

### üõ†Ô∏è DEPENDENCIAS T√âCNICAS

#### **Librer√≠as Python Principales:**
```
Flask>=2.0.1                  # Framework web
cryptography>=3.4.8          # Cifrado y seguridad
psutil>=5.8.0                # Informaci√≥n del sistema
requests>=2.31.0             # Comunicaci√≥n HTTP
beautifulsoup4>=4.9.3        # Procesamiento HTML
weasyprint>=52.5             # Generaci√≥n de PDFs
```

#### **Requisitos del Sistema:**
- ‚úÖ **Python:** 3.8 o superior
- ‚úÖ **RAM:** M√≠nimo 2GB, recomendado 4GB
- ‚úÖ **Almacenamiento:** 10GB libres para logs y documentos
- ‚úÖ **Red:** Conexi√≥n a Internet para comunicaci√≥n SENIAT
- ‚úÖ **SSL/TLS:** Certificados v√°lidos para HTTPS

---

### üöÄ INSTALACI√ìN Y CONFIGURACI√ìN

#### **1. Instalaci√≥n de Dependencias:**
```bash
pip install -r requirements.txt
```

#### **2. Configuraci√≥n SENIAT:**
```python
# Configurar credenciales SENIAT
comunicador_seniat.configurar_empresa(
    rif="J-123456789",
    codigo_contribuyente="ABC123",
    token_api="seniat-token-oficial"
)
```

#### **3. Inicializaci√≥n del Sistema:**
```bash
python app.py
```

#### **4. Verificaci√≥n de Funcionamiento:**
- Acceder a `/seniat/sistema/estado`
- Verificar conectividad con SENIAT
- Validar integridad de documentos

---

### üìã PRUEBAS Y CERTIFICACI√ìN

#### **Pruebas Implementadas:**
- ‚úÖ **Inmutabilidad:** Verificaci√≥n de hash y firmas
- ‚úÖ **Numeraci√≥n:** Validaci√≥n de consecutivos
- ‚úÖ **Logs:** Integridad de auditor√≠a
- ‚úÖ **Exportaci√≥n:** Formatos CSV/XML/JSON
- ‚úÖ **APIs:** Comunicaci√≥n con SENIAT (simulada)

#### **Casos de Prueba Cr√≠ticos:**
1. **Creaci√≥n de Factura Fiscal:** Numeraci√≥n autom√°tica + inmutabilidad
2. **Intento de Modificaci√≥n:** Verificar prevenci√≥n de cambios
3. **Exportaci√≥n SENIAT:** Validar formatos y contenido
4. **Logs de Auditor√≠a:** Verificar registro autom√°tico
5. **Consulta SENIAT:** Validar acceso y respuestas

---

### üìû CONTACTO T√âCNICO

**Desarrollador Principal:** [Nombre]  
**Email:** [email@dominio.com]  
**Tel√©fono:** [+58 XXX-XXXXXXX]  
**Soporte T√©cnico:** 24/7 disponible  

---

### üìÑ DECLARACI√ìN DE CUMPLIMIENTO

Este sistema ha sido desarrollado siguiendo estrictamente los **Requisitos T√©cnicos Clave para Homologaci√≥n SENIAT** especificados en la **Providencia 00102**, implementando:

‚úÖ **Inviolabilidad y Protecci√≥n de Datos** - Inmutabilidad y cifrado  
‚úÖ **Trazabilidad Completa** - Logs de auditor√≠a inalterables  
‚úÖ **Comunicaci√≥n Directa con SENIAT** - APIs y web services  
‚úÖ **Control de Documentos Fiscales** - Numeraci√≥n √∫nica y timestamps  
‚úÖ **Acceso y Auditor√≠a para el SENIAT** - Interfaz de consulta y exportaci√≥n  

El sistema est√° **LISTO PARA HOMOLOGACI√ìN SENIAT** y cumple con todos los requisitos t√©cnicos establecidos.

---

**Fecha de Documento:** 2024-01-15  
**Versi√≥n de Ficha T√©cnica:** 1.0  
**Estado:** COMPLETO - LISTO PARA HOMOLOGACI√ìN 